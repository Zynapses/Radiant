<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FILE CONVERSION SERVICE - RADIANT Documentation</title>
  
<style>
@media print {
  body { font-size: 11pt !important; }
  pre { page-break-inside: avoid; }
  h1, h2, h3 { page-break-after: avoid; }
  .no-print { display: none !important; }
}

* { box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  line-height: 1.7;
  color: #1d1d1f;
  max-width: 900px;
  margin: 0 auto;
  padding: 40px 30px;
  background: white;
}

h1 {
  color: #1d1d1f;
  border-bottom: 3px solid #0071e3;
  padding-bottom: 12px;
  font-size: 28px;
  margin-top: 0;
}

h2 {
  color: #1d1d1f;
  border-bottom: 1px solid #d2d2d7;
  padding-bottom: 8px;
  font-size: 22px;
  margin-top: 40px;
}

h3 { color: #1d1d1f; font-size: 18px; margin-top: 30px; }
h4 { color: #1d1d1f; font-size: 16px; margin-top: 25px; }

a { color: #0071e3; text-decoration: none; }
a:hover { text-decoration: underline; }

code {
  background: #f5f5f7;
  padding: 2px 6px;
  border-radius: 4px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  font-size: 0.9em;
  color: #1d1d1f;
}

pre {
  background: #1d1d1f;
  color: #f5f5f7;
  padding: 20px;
  border-radius: 10px;
  overflow-x: auto;
  font-size: 13px;
  line-height: 1.5;
}

pre code {
  background: transparent;
  padding: 0;
  color: inherit;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
  font-size: 14px;
}

th, td {
  border: 1px solid #d2d2d7;
  padding: 12px 15px;
  text-align: left;
}

th {
  background: #0071e3;
  color: white;
  font-weight: 600;
}

tr:nth-child(even) { background: #f5f5f7; }

blockquote {
  border-left: 4px solid #0071e3;
  margin: 20px 0;
  padding: 15px 25px;
  background: #f5f5f7;
  border-radius: 0 8px 8px 0;
}

blockquote p { margin: 0; }

img { max-width: 100%; height: auto; border-radius: 8px; }

hr {
  border: none;
  border-top: 1px solid #d2d2d7;
  margin: 40px 0;
}

ul, ol { padding-left: 25px; }
li { margin: 8px 0; }

.header-bar {
  background: linear-gradient(135deg, #0071e3 0%, #00c6ff 100%);
  color: white;
  padding: 20px 30px;
  margin: -40px -30px 30px -30px;
  border-radius: 0 0 16px 16px;
}

.header-bar h1 {
  color: white;
  border: none;
  margin: 0;
  padding: 0;
}

.header-bar .meta {
  font-size: 13px;
  opacity: 0.9;
  margin-top: 8px;
}

.print-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #0071e3;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  box-shadow: 0 4px 12px rgba(0,113,227,0.3);
}

.print-btn:hover { background: #0077ed; }

.mermaid {
  background: #f5f5f7;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  margin: 20px 0;
}

.footer {
  margin-top: 60px;
  padding-top: 20px;
  border-top: 1px solid #d2d2d7;
  color: #86868b;
  font-size: 12px;
  text-align: center;
}
</style>

</head>
<body>
  <button class="print-btn no-print" onclick="window.print()">ğŸ–¨ï¸ Print / Save as PDF</button>
  
  <div class="header-bar">
    <h1>FILE CONVERSION SERVICE</h1>
    <div class="meta">RADIANT v5.52.29 | docs/FILE-CONVERSION-SERVICE.md</div>
  </div>
  
  <h1 id="radiant-intelligent-file-conversion-service">RADIANT Intelligent File Conversion Service</h1>
<blockquote>
<p><strong>Version</strong>: 4.18.55<br />
<strong>Last Updated</strong>: December 2024<br />
<strong>Status</strong>: Production Ready</p>
</blockquote>
<hr />
<h2 id="overview">Overview</h2>
<p>The <strong>Intelligent File Conversion Service</strong> is a Radiant-side system that automatically decides when and how to convert files for AI providers. The core principle is <strong>â€œLet Radiant decide, not Think Tankâ€</strong> - Think Tank simply drops files, and Radiant determines the optimal conversion strategy based on the target AI providerâ€™s capabilities.</p>
<h3 id="key-principles">Key Principles</h3>
<ol type="1">
<li><strong>Think Tank submits files without worrying about provider compatibility</strong></li>
<li><strong>Radiant detects file format and checks target provider capabilities</strong></li>
<li><strong>Conversion only happens if the AI provider doesnâ€™t understand the format</strong></li>
<li><strong>Uses AI + libraries for intelligent conversion</strong></li>
</ol>
<hr />
<h2 id="architecture">Architecture</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              THINK TANK                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                 â”‚
â”‚  â”‚  User   â”‚â”€â”€â”¬â”€â”€â–¶ Drop file into chat                                      â”‚
â”‚  â”‚         â”‚  â”‚                                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              RADIANT                                         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Format Detectionâ”‚â”€â”€â”€â–¶â”‚ Provider Check  â”‚â”€â”€â”€â–¶â”‚ Decision Engine â”‚          â”‚
â”‚  â”‚   - MIME type   â”‚    â”‚   - Capabilitiesâ”‚    â”‚   - Strategy    â”‚          â”‚
â”‚  â”‚   - Extension   â”‚    â”‚   - Limits      â”‚    â”‚   - Warnings    â”‚          â”‚
â”‚  â”‚   - Magic bytes â”‚    â”‚   - Vision/Audioâ”‚    â”‚   - Token est.  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚                   â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”             â”‚
â”‚                         â”‚         Needs Conversion?            â”‚             â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                          â”‚                                   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚              â”‚ NO                        â”‚                      YES  â”‚       â”‚
â”‚              â–¼                           â”‚                           â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Return original â”‚                     â”‚            â”‚ Execute Strategyâ”‚    â”‚
â”‚  â”‚ file as-is      â”‚                     â”‚            â”‚ - extract_text  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚            â”‚ - ocr           â”‚    â”‚
â”‚                                          â”‚            â”‚ - transcribe    â”‚    â”‚
â”‚                                          â”‚            â”‚ - describe_imageâ”‚    â”‚
â”‚                                          â”‚            â”‚ - parse_data    â”‚    â”‚
â”‚                                          â”‚            â”‚ - decompress    â”‚    â”‚
â”‚                                          â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚                     â”‚             â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                     â”‚                        â”‚
â”‚                                                     â–¼                        â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                                          â”‚ Return Result   â”‚                 â”‚
â”‚                                          â”‚ - Converted textâ”‚                 â”‚
â”‚                                          â”‚ - Token estimateâ”‚                 â”‚
â”‚                                          â”‚ - Metadata      â”‚                 â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<hr />
<h2 id="supported-file-formats">Supported File Formats</h2>
<h3 id="documents">Documents</h3>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Conversion Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>PDF</td>
<td><code>.pdf</code></td>
<td><code>application/pdf</code></td>
<td><code>extract_text</code> via pdf-parse</td>
</tr>
<tr>
<td>Word</td>
<td><code>.docx</code>, <code>.doc</code></td>
<td><code>application/vnd.openxmlformats-officedocument.wordprocessingml.document</code></td>
<td><code>extract_text</code> via mammoth</td>
</tr>
<tr>
<td>PowerPoint</td>
<td><code>.pptx</code>, <code>.ppt</code></td>
<td><code>application/vnd.openxmlformats-officedocument.presentationml.presentation</code></td>
<td><code>extract_text</code></td>
</tr>
<tr>
<td>Excel</td>
<td><code>.xlsx</code>, <code>.xls</code></td>
<td><code>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</code></td>
<td><code>parse_data</code> via xlsx</td>
</tr>
</tbody>
</table>
<h3 id="text-files">Text Files</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Plain Text</td>
<td><code>.txt</code></td>
<td><code>text/plain</code></td>
<td>Direct passthrough</td>
</tr>
<tr>
<td>Markdown</td>
<td><code>.md</code></td>
<td><code>text/markdown</code></td>
<td>Direct passthrough</td>
</tr>
<tr>
<td>JSON</td>
<td><code>.json</code></td>
<td><code>application/json</code></td>
<td>Direct or <code>parse_data</code></td>
</tr>
<tr>
<td>CSV</td>
<td><code>.csv</code></td>
<td><code>text/csv</code></td>
<td><code>parse_data</code></td>
</tr>
<tr>
<td>XML</td>
<td><code>.xml</code></td>
<td><code>application/xml</code></td>
<td>Direct or <code>extract_text</code></td>
</tr>
<tr>
<td>HTML</td>
<td><code>.html</code></td>
<td><code>text/html</code></td>
<td><code>extract_text</code></td>
</tr>
</tbody>
</table>
<h3 id="images">Images</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Conversion Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>PNG</td>
<td><code>.png</code></td>
<td><code>image/png</code></td>
<td>Native or <code>describe_image</code></td>
</tr>
<tr>
<td>JPEG</td>
<td><code>.jpg</code>, <code>.jpeg</code></td>
<td><code>image/jpeg</code></td>
<td>Native or <code>describe_image</code></td>
</tr>
<tr>
<td>GIF</td>
<td><code>.gif</code></td>
<td><code>image/gif</code></td>
<td>Native or <code>describe_image</code></td>
</tr>
<tr>
<td>WebP</td>
<td><code>.webp</code></td>
<td><code>image/webp</code></td>
<td>Native or <code>describe_image</code></td>
</tr>
<tr>
<td>SVG</td>
<td><code>.svg</code></td>
<td><code>image/svg+xml</code></td>
<td>Convert to PNG or <code>describe_image</code></td>
</tr>
<tr>
<td>BMP</td>
<td><code>.bmp</code></td>
<td><code>image/bmp</code></td>
<td>Convert to PNG or <code>describe_image</code></td>
</tr>
<tr>
<td>TIFF</td>
<td><code>.tiff</code></td>
<td><code>image/tiff</code></td>
<td>Convert to PNG or <code>describe_image</code></td>
</tr>
</tbody>
</table>
<h3 id="audio">Audio</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Conversion Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>MP3</td>
<td><code>.mp3</code></td>
<td><code>audio/mpeg</code></td>
<td><code>transcribe</code> via Whisper</td>
</tr>
<tr>
<td>WAV</td>
<td><code>.wav</code></td>
<td><code>audio/wav</code></td>
<td><code>transcribe</code> via Whisper</td>
</tr>
<tr>
<td>OGG</td>
<td><code>.ogg</code></td>
<td><code>audio/ogg</code></td>
<td><code>transcribe</code> via Whisper</td>
</tr>
<tr>
<td>FLAC</td>
<td><code>.flac</code></td>
<td><code>audio/flac</code></td>
<td><code>transcribe</code> via Whisper</td>
</tr>
<tr>
<td>M4A</td>
<td><code>.m4a</code></td>
<td><code>audio/mp4</code></td>
<td><code>transcribe</code> via Whisper</td>
</tr>
</tbody>
</table>
<h3 id="video">Video</h3>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Conversion Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>MP4</td>
<td><code>.mp4</code></td>
<td><code>video/mp4</code></td>
<td><code>describe_video</code> - frame extraction</td>
</tr>
<tr>
<td>WebM</td>
<td><code>.webm</code></td>
<td><code>video/webm</code></td>
<td><code>describe_video</code> - frame extraction</td>
</tr>
<tr>
<td>MOV</td>
<td><code>.mov</code></td>
<td><code>video/quicktime</code></td>
<td><code>describe_video</code> - frame extraction</td>
</tr>
<tr>
<td>AVI</td>
<td><code>.avi</code></td>
<td><code>video/x-msvideo</code></td>
<td><code>describe_video</code> - frame extraction</td>
</tr>
</tbody>
</table>
<h3 id="code-files">Code Files</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td><code>.py</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>JavaScript</td>
<td><code>.js</code>, <code>.jsx</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>TypeScript</td>
<td><code>.ts</code>, <code>.tsx</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>Java</td>
<td><code>.java</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>C/C++</td>
<td><code>.c</code>, <code>.cpp</code>, <code>.h</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>Go</td>
<td><code>.go</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>Rust</td>
<td><code>.rs</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
<tr>
<td>Ruby</td>
<td><code>.rb</code></td>
<td>Syntax-highlighted markdown</td>
</tr>
</tbody>
</table>
<h3 id="archives">Archives</h3>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Format</th>
<th>Extension</th>
<th>MIME Type</th>
<th>Conversion Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>ZIP</td>
<td><code>.zip</code></td>
<td><code>application/zip</code></td>
<td><code>decompress</code> - extract contents</td>
</tr>
<tr>
<td>TAR</td>
<td><code>.tar</code></td>
<td><code>application/x-tar</code></td>
<td><code>decompress</code> - extract contents</td>
</tr>
<tr>
<td>GZIP</td>
<td><code>.gz</code>, <code>.tar.gz</code>, <code>.tgz</code></td>
<td><code>application/gzip</code></td>
<td><code>decompress</code> - extract contents</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="provider-capabilities">Provider Capabilities</h2>
<p>The service maintains a registry of AI provider capabilities:</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 21%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th>Provider</th>
<th>Vision</th>
<th>Audio</th>
<th>Video</th>
<th>Max File Size</th>
<th>Native Document Formats</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>OpenAI</strong></td>
<td>âœ… GPT-4V</td>
<td>âœ… Whisper</td>
<td>âŒ</td>
<td>20MB</td>
<td>txt, md, json, csv</td>
</tr>
<tr>
<td><strong>Anthropic</strong></td>
<td>âœ… Claude 3</td>
<td>âŒ</td>
<td>âŒ</td>
<td>32MB</td>
<td>pdf, txt, md, json, csv</td>
</tr>
<tr>
<td><strong>Google</strong></td>
<td>âœ… Gemini</td>
<td>âœ…</td>
<td>âœ…</td>
<td>100MB</td>
<td>pdf, txt, md, json, csv</td>
</tr>
<tr>
<td><strong>xAI</strong></td>
<td>âœ… Grok</td>
<td>âŒ</td>
<td>âŒ</td>
<td>20MB</td>
<td>txt, md, json</td>
</tr>
<tr>
<td><strong>DeepSeek</strong></td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
<td>10MB</td>
<td>txt, md, json, csv</td>
</tr>
<tr>
<td><strong>Self-hosted</strong></td>
<td>âœ… LLaVA</td>
<td>âœ… Whisper</td>
<td>âŒ</td>
<td>50MB</td>
<td>txt, md, json, csv</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="conversion-strategies">Conversion Strategies</h2>
<h3 id="none---no-conversion">1. <code>none</code> - No Conversion</h3>
<p>Provider natively supports the format. File is passed through as-is.</p>
<h3 id="extract_text---text-extraction">2. <code>extract_text</code> - Text Extraction</h3>
<p>Extracts plain text from documents using: - <strong>PDF</strong>: <code>pdf-parse</code> library - extracts all text, page metadata - <strong>DOCX/DOC</strong>: <code>mammoth</code> library - preserves structure, extracts images - <strong>PPTX/PPT</strong>: Text extraction from slides - <strong>HTML/XML</strong>: Strip tags, preserve content</p>
<p><strong>Example output:</strong></p>
<pre><code>[Document Title]
Page 1:
Content from first page...

Page 2:
Content from second page...

[Metadata]
Pages: 10
Author: John Doe
Created: 2024-01-15</code></pre>
<h3 id="ocr---optical-character-recognition">3. <code>ocr</code> - Optical Character Recognition</h3>
<p>Uses AWS Textract to extract text from images containing text.</p>
<p><strong>Features:</strong> - Detects printed and handwritten text - Table detection and extraction - Form field detection - Confidence scores per block</p>
<p><strong>Example output:</strong></p>
<pre><code>[OCR Result]
Confidence: 94.5%

INVOICE #12345
Date: January 15, 2024

Item          Qty    Price
Widget A       10    $50.00
Widget B        5    $25.00

Total: $625.00</code></pre>
<h3 id="transcribe---audio-transcription">4. <code>transcribe</code> - Audio Transcription</h3>
<p>Uses OpenAI Whisper API or self-hosted Whisper for speech-to-text.</p>
<p><strong>Features:</strong> - Automatic language detection - Timestamp segments - SRT/VTT subtitle generation - Speaker diarization (future)</p>
<p><strong>Example output:</strong></p>
<pre><code>[Transcription]
Duration: 5:32
Language: English
Model: whisper-1

[00:00] Hello and welcome to today&#39;s meeting.
[00:05] We&#39;ll be discussing the Q4 roadmap.
[00:12] First, let&#39;s review the current status...</code></pre>
<h3 id="describe_image---ai-image-description">5. <code>describe_image</code> - AI Image Description</h3>
<p>Uses vision-capable models to describe image contents.</p>
<p><strong>Supported Models:</strong> - GPT-4 Vision (OpenAI) - Claude 3 Vision (Anthropic) - LLaVA (self-hosted)</p>
<p><strong>Features:</strong> - Detailed scene description - Text detection (OCR integration) - Object identification - Color and composition analysis</p>
<p><strong>Example output:</strong></p>
<pre><code>[Image Description]
Model: gpt-4-vision
Dimensions: 1920x1080

This image shows a modern office space with an open floor plan. 
In the foreground, there are several desks arranged in clusters, 
each with monitors and office supplies. The walls are painted in 
a neutral gray tone with large windows providing natural light.

[Text detected in image]:
&quot;RADIANT - Innovation Center&quot;
&quot;Welcome Visitors&quot;</code></pre>
<h3 id="describe_video---video-frame-analysis">6. <code>describe_video</code> - Video Frame Analysis</h3>
<p>Extracts key frames from video and describes each using vision models.</p>
<p><strong>Features:</strong> - Configurable frame interval (default: 10 seconds) - Maximum frames limit (default: 10) - Frame-by-frame descriptions - Narrative summary generation</p>
<p><strong>Example output:</strong></p>
<pre><code>**Video Overview** (2m 30s, 1920x1080)

**Frame Analysis:**

**[0:00]** The video opens with a title screen showing the company logo
against a blue gradient background.

**[0:10]** A presenter in business attire stands in front of a whiteboard
with diagrams showing the system architecture.

**[0:20]** Close-up of the whiteboard showing a flowchart with boxes
labeled &quot;User Input&quot;, &quot;Processing&quot;, and &quot;Output&quot;.

...

**Summary:**
The video begins with: Company logo and title screen
The video ends with: Presenter summarizing key points with bullet list</code></pre>
<h3 id="parse_data---structured-data-parsing">7. <code>parse_data</code> - Structured Data Parsing</h3>
<p>Converts spreadsheets and data files to JSON.</p>
<p><strong>Supported formats:</strong> - CSV â†’ JSON array of objects - XLSX/XLS â†’ JSON with sheet data - JSON â†’ Validated and prettified</p>
<p><strong>Example output (CSV):</strong></p>
<pre class="json"><code>{
  &quot;data&quot;: [
    {&quot;name&quot;: &quot;Alice&quot;, &quot;email&quot;: &quot;alice@example.com&quot;, &quot;role&quot;: &quot;Admin&quot;},
    {&quot;name&quot;: &quot;Bob&quot;, &quot;email&quot;: &quot;bob@example.com&quot;, &quot;role&quot;: &quot;User&quot;},
    {&quot;name&quot;: &quot;Carol&quot;, &quot;email&quot;: &quot;carol@example.com&quot;, &quot;role&quot;: &quot;User&quot;}
  ],
  &quot;metadata&quot;: {
    &quot;rowCount&quot;: 3,
    &quot;columnCount&quot;: 3,
    &quot;headers&quot;: [&quot;name&quot;, &quot;email&quot;, &quot;role&quot;]
  }
}</code></pre>
<p><strong>Example output (Excel):</strong></p>
<pre class="json"><code>{
  &quot;sheets&quot;: [
    {
      &quot;name&quot;: &quot;Sales Data&quot;,
      &quot;rows&quot;: [...],
      &quot;headers&quot;: [&quot;Date&quot;, &quot;Product&quot;, &quot;Revenue&quot;],
      &quot;rowCount&quot;: 150
    },
    {
      &quot;name&quot;: &quot;Summary&quot;,
      &quot;rows&quot;: [...],
      &quot;headers&quot;: [&quot;Metric&quot;, &quot;Value&quot;],
      &quot;rowCount&quot;: 10
    }
  ],
  &quot;metadata&quot;: {
    &quot;sheetCount&quot;: 2,
    &quot;totalRows&quot;: 160,
    &quot;hasFormulas&quot;: true
  }
}</code></pre>
<h3 id="decompress---archive-extraction">8. <code>decompress</code> - Archive Extraction</h3>
<p>Extracts and processes archive contents.</p>
<p><strong>Supported formats:</strong> - ZIP (via adm-zip) - TAR (via tar) - GZIP (via zlib)</p>
<p><strong>Features:</strong> - Recursive extraction - Text file content inclusion - Binary file detection - Size limits enforcement</p>
<p><strong>Example output:</strong></p>
<pre><code>**Archive Contents** (ZIP)

**File Structure:**</code></pre>
<p>ğŸ“ project/ ğŸ“„ project/README.md (2.5KB) ğŸ“„ project/package.json (1.2KB) ğŸ“ project/src/ ğŸ“„ project/src/index.ts (5.3KB) ğŸ“„ project/src/utils.ts (3.1KB)</p>
<pre><code>
**File Contents:**

### project/README.md

```markdown
# My Project

This is a sample project...</code></pre>
<h3 id="projectpackage.json">project/package.json</h3>
<pre class="json"><code>{
  &quot;name&quot;: &quot;my-project&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;
}</code></pre>
<pre><code>
### 9. `render_code` - Code Formatting
Formats code files with syntax highlighting.

**Example output:**
````markdown
```typescript
import { Injectable } from &#39;@angular/core&#39;;

@Injectable()
export class DataService {
  private data: string[] = [];

  getData(): string[] {
    return this.data;
  }
}</code></pre>
<p>````</p>
<hr />
<h2 id="api-reference">API Reference</h2>
<h3 id="base-path">Base Path</h3>
<p><code>/api/thinktank/files</code></p>
<h3 id="endpoints">Endpoints</h3>
<h4 id="process-file">Process File</h4>
<pre><code>POST /api/thinktank/files/process</code></pre>
<p><strong>Request:</strong></p>
<pre class="json"><code>{
  &quot;filename&quot;: &quot;document.pdf&quot;,
  &quot;mimeType&quot;: &quot;application/pdf&quot;,
  &quot;content&quot;: &quot;&lt;base64-encoded-content&gt;&quot;,
  &quot;targetProvider&quot;: &quot;anthropic&quot;,
  &quot;targetModel&quot;: &quot;claude-3-5-sonnet&quot;,
  &quot;conversationId&quot;: &quot;conv-uuid-optional&quot;
}</code></pre>
<p><strong>Response:</strong></p>
<pre class="json"><code>{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;conversionId&quot;: &quot;conv_abc123&quot;,
    &quot;originalFile&quot;: {
      &quot;filename&quot;: &quot;document.pdf&quot;,
      &quot;format&quot;: &quot;pdf&quot;,
      &quot;size&quot;: 1048576,
      &quot;checksum&quot;: &quot;sha256:abc123...&quot;
    },
    &quot;convertedContent&quot;: {
      &quot;type&quot;: &quot;text&quot;,
      &quot;content&quot;: &quot;Extracted document text...&quot;,
      &quot;tokenEstimate&quot;: 2500,
      &quot;metadata&quot;: {
        &quot;originalFormat&quot;: &quot;pdf&quot;,
        &quot;conversionStrategy&quot;: &quot;extract_text&quot;,
        &quot;pageCount&quot;: 10,
        &quot;title&quot;: &quot;Annual Report 2024&quot;,
        &quot;author&quot;: &quot;Finance Team&quot;
      }
    },
    &quot;processingTimeMs&quot;: 1250
  }
}</code></pre>
<h4 id="check-compatibility">Check Compatibility</h4>
<pre><code>POST /api/thinktank/files/check-compatibility</code></pre>
<p><strong>Request:</strong></p>
<pre class="json"><code>{
  &quot;filename&quot;: &quot;image.png&quot;,
  &quot;mimeType&quot;: &quot;image/png&quot;,
  &quot;fileSize&quot;: 524288,
  &quot;targetProvider&quot;: &quot;deepseek&quot;
}</code></pre>
<p><strong>Response:</strong></p>
<pre class="json"><code>{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;fileInfo&quot;: {
      &quot;filename&quot;: &quot;image.png&quot;,
      &quot;format&quot;: &quot;png&quot;,
      &quot;size&quot;: 524288
    },
    &quot;provider&quot;: {
      &quot;id&quot;: &quot;deepseek&quot;,
      &quot;supportsFormat&quot;: false,
      &quot;supportsVision&quot;: false,
      &quot;maxFileSize&quot;: 10485760
    },
    &quot;decision&quot;: {
      &quot;needsConversion&quot;: true,
      &quot;strategy&quot;: &quot;describe_image&quot;,
      &quot;reason&quot;: &quot;Provider deepseek lacks vision - will use AI to describe image&quot;,
      &quot;targetFormat&quot;: &quot;txt&quot;,
      &quot;warnings&quot;: []
    }
  }
}</code></pre>
<h4 id="get-provider-capabilities">Get Provider Capabilities</h4>
<pre><code>GET /api/thinktank/files/capabilities
GET /api/thinktank/files/capabilities?provider=anthropic</code></pre>
<p><strong>Response:</strong></p>
<pre class="json"><code>{
  &quot;success&quot;: true,
  &quot;data&quot;: [
    {
      &quot;providerId&quot;: &quot;anthropic&quot;,
      &quot;supportedFormats&quot;: [&quot;png&quot;, &quot;jpg&quot;, &quot;jpeg&quot;, &quot;gif&quot;, &quot;webp&quot;, &quot;pdf&quot;, &quot;txt&quot;, &quot;md&quot;, &quot;json&quot;, &quot;csv&quot;],
      &quot;nativeDocumentFormats&quot;: [&quot;pdf&quot;, &quot;txt&quot;, &quot;md&quot;, &quot;json&quot;, &quot;csv&quot;],
      &quot;maxFileSize&quot;: 33554432,
      &quot;supportsVision&quot;: true,
      &quot;supportsAudio&quot;: false,
      &quot;supportsVideo&quot;: false,
      &quot;supportsDocuments&quot;: true
    }
  ]
}</code></pre>
<h4 id="get-conversion-history">Get Conversion History</h4>
<pre><code>GET /api/thinktank/files/history
GET /api/thinktank/files/history?conversationId=conv-uuid&amp;limit=50&amp;offset=0</code></pre>
<p><strong>Response:</strong></p>
<pre class="json"><code>{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;conversions&quot;: [
      {
        &quot;id&quot;: &quot;conv_abc123&quot;,
        &quot;filename&quot;: &quot;report.pdf&quot;,
        &quot;originalFormat&quot;: &quot;pdf&quot;,
        &quot;originalSize&quot;: 1048576,
        &quot;targetProvider&quot;: &quot;anthropic&quot;,
        &quot;needsConversion&quot;: true,
        &quot;strategy&quot;: &quot;extract_text&quot;,
        &quot;status&quot;: &quot;completed&quot;,
        &quot;tokenEstimate&quot;: 2500,
        &quot;processingTimeMs&quot;: 1250,
        &quot;createdAt&quot;: &quot;2024-12-31T00:00:00Z&quot;
      }
    ],
    &quot;pagination&quot;: {
      &quot;limit&quot;: 50,
      &quot;offset&quot;: 0
    }
  }
}</code></pre>
<h4 id="get-conversion-statistics">Get Conversion Statistics</h4>
<pre><code>GET /api/thinktank/files/stats
GET /api/thinktank/files/stats?days=30</code></pre>
<p><strong>Response:</strong></p>
<pre class="json"><code>{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;totalFiles&quot;: 1250,
    &quot;convertedCount&quot;: 890,
    &quot;nativeCount&quot;: 360,
    &quot;failedCount&quot;: 12,
    &quot;totalBytesProcessed&quot;: 2147483648,
    &quot;avgProcessingMs&quot;: 850,
    &quot;mostCommonFormat&quot;: &quot;pdf&quot;,
    &quot;mostCommonStrategy&quot;: &quot;extract_text&quot;,
    &quot;periodDays&quot;: 30
  }
}</code></pre>
<hr />
<h2 id="database-schema">Database Schema</h2>
<h3 id="tables">Tables</h3>
<h4 id="file_conversions"><code>file_conversions</code></h4>
<p>Tracks all file conversion decisions and results.</p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 22%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>UUID</td>
<td>Primary key</td>
</tr>
<tr>
<td><code>tenant_id</code></td>
<td>UUID</td>
<td>Tenant reference</td>
</tr>
<tr>
<td><code>filename</code></td>
<td>VARCHAR(500)</td>
<td>Original filename</td>
</tr>
<tr>
<td><code>original_format</code></td>
<td>VARCHAR(50)</td>
<td>Detected format</td>
</tr>
<tr>
<td><code>original_size</code></td>
<td>BIGINT</td>
<td>File size in bytes</td>
</tr>
<tr>
<td><code>target_provider</code></td>
<td>VARCHAR(100)</td>
<td>Target AI provider</td>
</tr>
<tr>
<td><code>target_model</code></td>
<td>VARCHAR(200)</td>
<td>Target model ID</td>
</tr>
<tr>
<td><code>needs_conversion</code></td>
<td>BOOLEAN</td>
<td>Whether conversion was needed</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td>VARCHAR(50)</td>
<td>Conversion strategy used</td>
</tr>
<tr>
<td><code>conversion_status</code></td>
<td>VARCHAR(20)</td>
<td>pending, processing, completed, failed</td>
</tr>
<tr>
<td><code>converted_token_estimate</code></td>
<td>INTEGER</td>
<td>Estimated tokens</td>
</tr>
<tr>
<td><code>processing_time_ms</code></td>
<td>INTEGER</td>
<td>Processing duration</td>
</tr>
<tr>
<td><code>created_at</code></td>
<td>TIMESTAMPTZ</td>
<td>Creation timestamp</td>
</tr>
</tbody>
</table>
<h4 id="provider_file_capabilities"><code>provider_file_capabilities</code></h4>
<p>Registry of provider file format support.</p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 22%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>provider_id</code></td>
<td>VARCHAR(100)</td>
<td>Provider identifier (unique)</td>
</tr>
<tr>
<td><code>supported_formats</code></td>
<td>JSONB</td>
<td>Array of supported formats</td>
</tr>
<tr>
<td><code>native_document_formats</code></td>
<td>JSONB</td>
<td>Formats provider handles natively</td>
</tr>
<tr>
<td><code>max_file_size</code></td>
<td>BIGINT</td>
<td>Maximum file size in bytes</td>
</tr>
<tr>
<td><code>supports_vision</code></td>
<td>BOOLEAN</td>
<td>Has vision capabilities</td>
</tr>
<tr>
<td><code>supports_audio</code></td>
<td>BOOLEAN</td>
<td>Has audio capabilities</td>
</tr>
<tr>
<td><code>supports_video</code></td>
<td>BOOLEAN</td>
<td>Has video capabilities</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="configuration">Configuration</h2>
<h3 id="environment-variables">Environment Variables</h3>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 40%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FILE_CONVERSION_BUCKET</code></td>
<td>S3 bucket for file storage</td>
<td><code>radiant-files</code></td>
</tr>
<tr>
<td><code>OPENAI_API_KEY</code></td>
<td>OpenAI API key for Whisper/Vision</td>
<td>Required</td>
</tr>
<tr>
<td><code>ANTHROPIC_API_KEY</code></td>
<td>Anthropic API key for Claude Vision</td>
<td>Optional</td>
</tr>
<tr>
<td><code>WHISPER_ENDPOINT_URL</code></td>
<td>Self-hosted Whisper endpoint</td>
<td>Optional</td>
</tr>
<tr>
<td><code>VISION_ENDPOINT_URL</code></td>
<td>Self-hosted vision endpoint</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<h3 id="admin-configuration">Admin Configuration</h3>
<p><strong>Location</strong>: Admin Dashboard â†’ Think Tank â†’ File Settings</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Max file size</td>
<td>50MB</td>
<td>Maximum upload size</td>
</tr>
<tr>
<td>Conversion timeout</td>
<td>30s</td>
<td>Processing timeout</td>
</tr>
<tr>
<td>Enable transcription</td>
<td>true</td>
<td>Audio â†’ text</td>
</tr>
<tr>
<td>Enable OCR</td>
<td>true</td>
<td>Image text extraction</td>
</tr>
<tr>
<td>Enable video processing</td>
<td>false</td>
<td>Video frame extraction</td>
</tr>
<tr>
<td>Retention days</td>
<td>30</td>
<td>How long to keep converted files</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="implementation-files">Implementation Files</h2>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lambda/shared/services/file-conversion.service.ts</code></td>
<td>Main service with decision engine</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/pdf-converter.ts</code></td>
<td>PDF text extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/docx-converter.ts</code></td>
<td>DOCX/DOC text extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/excel-converter.ts</code></td>
<td>Excel/CSV parsing</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/audio-converter.ts</code></td>
<td>Audio transcription</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/image-converter.ts</code></td>
<td>Image description &amp; OCR</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/video-converter.ts</code></td>
<td>Video frame extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/archive-converter.ts</code></td>
<td>Archive decompression</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/index.ts</code></td>
<td>Module exports</td>
</tr>
<tr>
<td><code>lambda/thinktank/file-conversion.ts</code></td>
<td>API handlers</td>
</tr>
<tr>
<td><code>migrations/127_file_conversion_service.sql</code></td>
<td>Database schema</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="dependencies">Dependencies</h2>
<h3 id="npm-packages">NPM Packages</h3>
<pre class="json"><code>{
  &quot;pdf-parse&quot;: &quot;^1.1.1&quot;,
  &quot;mammoth&quot;: &quot;^1.6.0&quot;,
  &quot;xlsx&quot;: &quot;^0.18.5&quot;,
  &quot;sharp&quot;: &quot;^0.33.2&quot;,
  &quot;fluent-ffmpeg&quot;: &quot;^2.1.2&quot;,
  &quot;adm-zip&quot;: &quot;^0.5.10&quot;,
  &quot;tar&quot;: &quot;^6.2.0&quot;
}</code></pre>
<h3 id="aws-services">AWS Services</h3>
<ul>
<li><strong>S3</strong>: File storage</li>
<li><strong>Textract</strong>: OCR processing</li>
<li><strong>Lambda</strong>: Processing execution</li>
</ul>
<hr />
<h2 id="error-handling">Error Handling</h2>
<h3 id="common-errors">Common Errors</h3>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr>
<th>Error</th>
<th>Cause</th>
<th>Resolution</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>File size exceeds limit</code></td>
<td>File &gt; provider max</td>
<td>Reduce file size or extract portions</td>
</tr>
<tr>
<td><code>Unsupported format</code></td>
<td>Unknown file type</td>
<td>Convert to supported format first</td>
</tr>
<tr>
<td><code>OCR failed</code></td>
<td>Textract error</td>
<td>Check image quality, retry</td>
</tr>
<tr>
<td><code>Transcription failed</code></td>
<td>Whisper error</td>
<td>Check audio quality, verify API key</td>
</tr>
<tr>
<td><code>PDF is password protected</code></td>
<td>Encrypted PDF</td>
<td>Provide unencrypted version</td>
</tr>
</tbody>
</table>
<h3 id="error-response-format">Error Response Format</h3>
<pre class="json"><code>{
  &quot;success&quot;: false,
  &quot;error&quot;: &quot;PDF extraction failed: File is password protected&quot;,
  &quot;conversionId&quot;: &quot;conv_abc123&quot;,
  &quot;originalFile&quot;: {
    &quot;filename&quot;: &quot;protected.pdf&quot;,
    &quot;format&quot;: &quot;pdf&quot;,
    &quot;size&quot;: 1048576
  },
  &quot;processingTimeMs&quot;: 150
}</code></pre>
<hr />
<h2 id="security-considerations">Security Considerations</h2>
<ol type="1">
<li><strong>File Size Limits</strong>: Enforced per provider to prevent resource exhaustion</li>
<li><strong>Format Validation</strong>: Magic bytes + extension verification</li>
<li><strong>Tenant Isolation</strong>: RLS policies on all tables</li>
<li><strong>S3 Encryption</strong>: AES-256 at rest</li>
<li><strong>Signed URLs</strong>: Time-limited access to stored files</li>
<li><strong>Input Sanitization</strong>: All filenames and metadata sanitized</li>
</ol>
<hr />
<h2 id="monitoring">Monitoring</h2>
<h3 id="metrics">Metrics</h3>
<ul>
<li>Total files processed per tenant</li>
<li>Conversion success/failure rate</li>
<li>Average processing time</li>
<li>Most common formats</li>
<li>Most common conversion strategies</li>
<li>Storage usage</li>
</ul>
<h3 id="alerts">Alerts</h3>
<ul>
<li>High failure rate (&gt;5%)</li>
<li>Processing time &gt; 30s</li>
<li>Storage quota approaching limit</li>
</ul>
<hr />
<hr />
<h2 id="domain-specific-file-formats">Domain-Specific File Formats</h2>
<p>The service includes a comprehensive registry of domain-specific file formats that are widely used in specialized fields but not commonly supported by mainstream AI providers.</p>
<h3 id="mechanical-engineering-cad">Mechanical Engineering / CAD</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 28%" />
<col style="width: 30%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>STEP</strong></td>
<td><code>.step</code>, <code>.stp</code>, <code>.p21</code></td>
<td>ISO 10303 CAD exchange</td>
<td>OpenCASCADE, FreeCAD</td>
</tr>
<tr>
<td><strong>STL</strong></td>
<td><code>.stl</code></td>
<td>3D printing mesh</td>
<td>numpy-stl, trimesh</td>
</tr>
<tr>
<td><strong>OBJ</strong></td>
<td><code>.obj</code></td>
<td>Wavefront 3D model</td>
<td>trimesh, three.js</td>
</tr>
<tr>
<td><strong>Fusion 360</strong></td>
<td><code>.f3d</code>, <code>.f3z</code></td>
<td>Autodesk parametric CAD</td>
<td>Fusion 360 API</td>
</tr>
<tr>
<td><strong>IGES</strong></td>
<td><code>.iges</code>, <code>.igs</code></td>
<td>Legacy CAD exchange</td>
<td>OpenCASCADE</td>
</tr>
<tr>
<td><strong>DXF</strong></td>
<td><code>.dxf</code></td>
<td>AutoCAD 2D drawings</td>
<td>ezdxf</td>
</tr>
<tr>
<td><strong>GLTF/GLB</strong></td>
<td><code>.gltf</code>, <code>.glb</code></td>
<td>Web 3D format</td>
<td>three.js, trimesh</td>
</tr>
</tbody>
</table>
<h3 id="electrical-engineering">Electrical Engineering</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 28%" />
<col style="width: 30%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>KiCad</strong></td>
<td><code>.kicad_pcb</code>, <code>.kicad_sch</code></td>
<td>PCB/schematic</td>
<td>kicad-cli, kiutils</td>
</tr>
<tr>
<td><strong>EAGLE</strong></td>
<td><code>.brd</code>, <code>.sch</code></td>
<td>Autodesk PCB</td>
<td>eagle-to-kicad</td>
</tr>
<tr>
<td><strong>SPICE</strong></td>
<td><code>.spice</code>, <code>.sp</code>, <code>.cir</code></td>
<td>Circuit simulation</td>
<td>PySpice, ngspice</td>
</tr>
</tbody>
</table>
<h3 id="medicalhealthcare">Medical/Healthcare</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DICOM</strong></td>
<td><code>.dcm</code>, <code>.dicom</code></td>
<td>Medical imaging</td>
<td>pydicom, dcmtk</td>
</tr>
<tr>
<td><strong>HL7 FHIR</strong></td>
<td><code>.json</code>, <code>.xml</code></td>
<td>Health records</td>
<td>fhir.resources</td>
</tr>
</tbody>
</table>
<h3 id="scientificresearch">Scientific/Research</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>NetCDF</strong></td>
<td><code>.nc</code>, <code>.nc4</code></td>
<td>Climate/geoscience</td>
<td>netCDF4, xarray</td>
</tr>
<tr>
<td><strong>HDF5</strong></td>
<td><code>.h5</code>, <code>.hdf5</code></td>
<td>Scientific data</td>
<td>h5py</td>
</tr>
<tr>
<td><strong>FITS</strong></td>
<td><code>.fits</code></td>
<td>Astronomy data</td>
<td>astropy</td>
</tr>
</tbody>
</table>
<h3 id="geospatial">Geospatial</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Shapefile</strong></td>
<td><code>.shp</code>, <code>.dbf</code></td>
<td>Vector GIS</td>
<td>geopandas, shapefile</td>
</tr>
<tr>
<td><strong>GeoTIFF</strong></td>
<td><code>.tif</code>, <code>.geotiff</code></td>
<td>Georeferenced raster</td>
<td>rasterio</td>
</tr>
</tbody>
</table>
<h3 id="bioinformatics">Bioinformatics</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>Extensions</th>
<th>Description</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FASTA</strong></td>
<td><code>.fasta</code>, <code>.fa</code></td>
<td>DNA/protein sequences</td>
<td>Biopython</td>
</tr>
<tr>
<td><strong>PDB</strong></td>
<td><code>.pdb</code></td>
<td>Protein structure</td>
<td>Biopython, py3Dmol</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="multi-model-file-preparation">Multi-Model File Preparation</h2>
<p>When multiple AI models work on the same prompt (multi-model orchestration), the system makes <strong>per-model conversion decisions</strong>:</p>
<h3 id="key-principle">Key Principle</h3>
<blockquote>
<p><strong>â€œIf a model accepts the file type, assume it understands it unless proven otherwise.â€</strong></p>
</blockquote>
<ul>
<li>Only convert for models that donâ€™t support the format</li>
<li>Pass original file to models with native support</li>
<li>Cache conversions to avoid redundant processing</li>
</ul>
<h3 id="how-it-works">How It Works</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MULTI-MODEL FILE PREPARATION                         â”‚
â”‚                                                                              â”‚
â”‚  File: document.pdf                                                          â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Claude 3.5    â”‚  â”‚   GPT-4 Vision  â”‚  â”‚    DeepSeek     â”‚              â”‚
â”‚  â”‚   (Anthropic)   â”‚  â”‚    (OpenAI)     â”‚  â”‚                 â”‚              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚ PDF: âœ… Native  â”‚  â”‚ PDF: âŒ No      â”‚  â”‚ PDF: âŒ No      â”‚              â”‚
â”‚  â”‚ Vision: âœ…      â”‚  â”‚ Vision: âœ…      â”‚  â”‚ Vision: âŒ      â”‚              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚ Action:         â”‚  â”‚ Action:         â”‚  â”‚ Action:         â”‚              â”‚
â”‚  â”‚ PASS ORIGINAL   â”‚  â”‚ CONVERT         â”‚  â”‚ CONVERT         â”‚              â”‚
â”‚  â”‚ (native PDF)    â”‚  â”‚ (extract text)  â”‚  â”‚ (extract text)  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                              â”‚                     â”‚                        â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                         â”‚                                   â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                              â”‚  CACHED CONVERSION  â”‚                        â”‚
â”‚                              â”‚  (convert once,     â”‚                        â”‚
â”‚                              â”‚   reuse for both)   â”‚                        â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h3 id="per-model-actions">Per-Model Actions</h3>
<table>
<colgroup>
<col style="width: 36%" />
<col style="width: 27%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr>
<th>Action</th>
<th>When</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pass_original</code></td>
<td>Model natively supports format</td>
<td>Original file passed</td>
</tr>
<tr>
<td><code>convert</code></td>
<td>Model doesnâ€™t support format</td>
<td>Converted content passed</td>
</tr>
<tr>
<td><code>skip</code></td>
<td>File too large or conversion failed</td>
<td>Model excluded</td>
</tr>
</tbody>
</table>
<h3 id="usage-example">Usage Example</h3>
<pre class="typescript"><code>import { multiModelFilePrepService } from &#39;./multi-model-file-prep.service&#39;;

// Prepare file for 3 models
const result = await multiModelFilePrepService.prepareFileForModels({
  tenantId,
  userId,
  file: {
    content: pdfBuffer,
    filename: &#39;document.pdf&#39;,
    mimeType: &#39;application/pdf&#39;,
  },
  targetModels: [
    { modelId: &#39;claude-3-5-sonnet&#39;, providerId: &#39;anthropic&#39; },
    { modelId: &#39;gpt-4-vision&#39;, providerId: &#39;openai&#39; },
    { modelId: &#39;deepseek-chat&#39;, providerId: &#39;deepseek&#39; },
  ],
});

// Result:
// - Claude: pass_original (native PDF support)
// - GPT-4: convert (no PDF support, extract text)
// - DeepSeek: convert (reuses cached conversion)

// Get content for each model
for (const model of result.perModelPrep) {
  if (model.action !== &#39;skip&#39;) {
    const content = multiModelFilePrepService.getContentForModel(result, model.modelId);
    // Use content.data with this model
  }
}</code></pre>
<h3 id="model-format-overrides">Model Format Overrides</h3>
<p>When a model claims to support a format but proves it doesnâ€™t understand it well, overrides can be added:</p>
<pre class="typescript"><code>// If Claude struggles with complex PDFs despite claiming support
multiModelFilePrepService.addFormatOverride(
  &#39;claude-3-haiku&#39;,
  &#39;pdf&#39;,
  &#39;Struggles with multi-column PDFs&#39;
);
// Now Claude 3 Haiku will get converted PDFs instead of originals</code></pre>
<hr />
<h2 id="agi-brain-integration">AGI Brain Integration</h2>
<p>The AGI Brain automatically detects domain-specific files and selects appropriate conversion strategies.</p>
<h3 id="how-it-works-1">How It Works</h3>
<ol type="1">
<li><strong>File Detection</strong>: When a file is uploaded, the system checks if itâ€™s a domain-specific format</li>
<li><strong>Domain Context</strong>: The userâ€™s domain (from profile or conversation) influences strategy selection</li>
<li><strong>Library Selection</strong>: The AGI Brain selects the best library based on availability and capabilities</li>
<li><strong>Conversion Planning</strong>: A conversion plan is created with fallback strategies</li>
<li><strong>Execution</strong>: The conversion is executed using the selected library</li>
</ol>
<h3 id="conversion-strategy-selection">Conversion Strategy Selection</h3>
<p>The AGI Brain considers: - <strong>Userâ€™s domain</strong>: Technical users get more detailed extraction - <strong>Conversation context</strong>: â€œshow me a previewâ€ â†’ visual output, â€œexport dataâ€ â†’ structured data - <strong>File complexity</strong>: Simple formats get direct parsing, complex ones may need external tools - <strong>Available libraries</strong>: Falls back if preferred library isnâ€™t available</p>
<h3 id="example-cad-file-processing">Example: CAD File Processing</h3>
<pre class="typescript"><code>// AGI Brain detects a STEP file
const plan = planDomainConversion(
  &#39;assembly.step&#39;,
  &#39;application/step&#39;,
  &#39;mechanical_engineering&#39;,  // User&#39;s domain
  &#39;Can you analyze this CAD model?&#39;  // Conversation context
);

// Returns:
{
  format: { format: &#39;step&#39;, domain: &#39;mechanical_engineering&#39;, ... },
  selectedStrategy: { strategy: &#39;extract_geometry&#39;, outputFormat: &#39;text&#39;, ... },
  selectedLibrary: { name: &#39;OpenCASCADE&#39;, pythonPackage: &#39;OCC&#39;, ... },
  requiresExternalService: true,
  estimatedComplexity: &#39;complex&#39;
}</code></pre>
<h3 id="ai-description-prompts">AI Description Prompts</h3>
<p>Each domain format includes a specialized AI prompt for when the AGI needs to describe the file without full parsing:</p>
<pre class="typescript"><code>// STL file prompt
&quot;This is an STL 3D model file. Describe the shape, identify what object 
it might be, assess printability, and note any potential issues for 3D printing.&quot;

// DICOM file prompt
&quot;This is a DICOM medical image. Describe the imaging modality, anatomical 
region, and any visible findings. Note: Do not provide medical diagnoses.&quot;

// STEP file prompt  
&quot;This is a STEP CAD file. Describe the mechanical part or assembly, 
including approximate geometry, features (holes, fillets, chamfers), 
and likely manufacturing process.&quot;</code></pre>
<hr />
<h2 id="implementation-files-1">Implementation Files</h2>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lambda/shared/services/file-conversion.service.ts</code></td>
<td>Main service with decision engine</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/pdf-converter.ts</code></td>
<td>PDF text extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/docx-converter.ts</code></td>
<td>DOCX/DOC text extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/excel-converter.ts</code></td>
<td>Excel/CSV parsing</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/audio-converter.ts</code></td>
<td>Audio transcription</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/image-converter.ts</code></td>
<td>Image description &amp; OCR</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/video-converter.ts</code></td>
<td>Video frame extraction</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/archive-converter.ts</code></td>
<td>Archive decompression</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/cad-converter.ts</code></td>
<td>CAD/3D file parsing (STL, OBJ, STEP, DXF, GLTF)</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/domain-formats.ts</code></td>
<td>Domain format registry (50+ formats)</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/domain-converter-selector.ts</code></td>
<td>AGI Brain integration</td>
</tr>
<tr>
<td><code>lambda/shared/services/converters/index.ts</code></td>
<td>Module exports</td>
</tr>
<tr>
<td><code>lambda/thinktank/file-conversion.ts</code></td>
<td>API handlers</td>
</tr>
<tr>
<td><code>migrations/127_file_conversion_service.sql</code></td>
<td>Database schema</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="reinforcement-learning-integration">Reinforcement Learning Integration</h2>
<p>The file conversion system integrates with the AGI Brain/consciousness for persistent learning from conversion outcomes.</p>
<h3 id="how-learning-works">How Learning Works</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REINFORCEMENT LEARNING LOOP                               â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   File      â”‚â”€â”€â”€â–¶â”‚  Decision   â”‚â”€â”€â”€â–¶â”‚   Model     â”‚â”€â”€â”€â–¶â”‚  Outcome    â”‚   â”‚
â”‚  â”‚   Upload    â”‚    â”‚  Engine     â”‚    â”‚  Response   â”‚    â”‚  Detection  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â–²                                      â”‚          â”‚
â”‚                            â”‚                                      â–¼          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                    â”‚   Learning    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Feedback   â”‚     â”‚
â”‚                    â”‚   Database    â”‚                     â”‚  Recording  â”‚     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h3 id="what-gets-learned">What Gets Learned</h3>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr>
<th>Signal</th>
<th>Source</th>
<th>Learning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>User Rating</strong></td>
<td>Explicit feedback (1-5 stars)</td>
<td>Direct quality signal</td>
</tr>
<tr>
<td><strong>Model Response</strong></td>
<td>Auto-inferred from response text</td>
<td>Did model understand?</td>
</tr>
<tr>
<td><strong>Error Detection</strong></td>
<td>Model errors/hallucinations</td>
<td>Format incompatibility</td>
</tr>
<tr>
<td><strong>Conversion Success</strong></td>
<td>Pass original worked</td>
<td>Model handles format</td>
</tr>
<tr>
<td><strong>Conversion Failure</strong></td>
<td>Pass original failed</td>
<td>Model needs conversion</td>
</tr>
</tbody>
</table>
<h3 id="understanding-score">Understanding Score</h3>
<p>Each model/format combination has an understanding score (0.0 to 1.0):</p>
<table>
<thead>
<tr>
<th>Score</th>
<th>Meaning</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.8 - 1.0</td>
<td>Excellent understanding</td>
<td>Pass original</td>
</tr>
<tr>
<td>0.6 - 0.8</td>
<td>Good understanding</td>
<td>Pass original</td>
</tr>
<tr>
<td>0.4 - 0.6</td>
<td>Moderate understanding</td>
<td>May convert</td>
</tr>
<tr>
<td>0.0 - 0.4</td>
<td>Poor understanding</td>
<td>Convert</td>
</tr>
</tbody>
</table>
<h3 id="learning-database-schema">Learning Database Schema</h3>
<p><strong>Migration:</strong> <code>128_file_conversion_learning.sql</code></p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_format_understanding</code></td>
<td>Per-tenant model/format understanding scores</td>
</tr>
<tr>
<td><code>conversion_outcome_feedback</code></td>
<td>Recorded feedback for learning</td>
</tr>
<tr>
<td><code>format_understanding_events</code></td>
<td>Audit trail of score changes</td>
</tr>
<tr>
<td><code>global_format_learning</code></td>
<td>Cross-tenant aggregate insights</td>
</tr>
</tbody>
</table>
<h3 id="recording-feedback">Recording Feedback</h3>
<pre class="typescript"><code>import { fileConversionLearningService } from &#39;./file-conversion-learning.service&#39;;

// Record outcome after model responds
await fileConversionLearningService.recordOutcomeFeedback({
  tenantId,
  userId,
  conversionId: &#39;conv_abc123&#39;,
  modelId: &#39;claude-3-5-sonnet&#39;,
  providerId: &#39;anthropic&#39;,
  filename: &#39;document.pdf&#39;,
  fileFormat: &#39;pdf&#39;,
  actionTaken: &#39;pass_original&#39;,
  outcome: &#39;success&#39;,  // or &#39;partial&#39;, &#39;failure&#39;
  outcomeSource: &#39;user_feedback&#39;,
  userRating: 5,
  modelUnderstood: true,
});

// Result: Understanding score updated, learning candidate created if significant</code></pre>
<h3 id="auto-inference-from-response">Auto-Inference from Response</h3>
<p>The system can automatically infer outcomes from model responses:</p>
<pre class="typescript"><code>const inference = fileConversionLearningService.inferOutcomeFromResponse(
  modelResponse,
  &#39;pdf&#39;
);

// Returns:
// {
//   outcome: &#39;failure&#39;,
//   modelUnderstood: false,
//   modelMentionedFormatIssues: true,
//   confidence: 0.8
// }</code></pre>
<p><strong>Failure signals detected:</strong> - â€œI canâ€™t readâ€, â€œunable to processâ€, â€œcannot access the fileâ€ - â€œappears to be emptyâ€, â€œbinary dataâ€, â€œbase64â€ - Model asking for clarification about file content</p>
<h3 id="integration-with-consciousness">Integration with Consciousness</h3>
<p>Significant learning events create <strong>Learning Candidates</strong> for the consciousness system:</p>
<table style="width:100%;">
<colgroup>
<col style="width: 17%" />
<col style="width: 60%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr>
<th>Event</th>
<th>Learning Candidate Type</th>
<th>Quality</th>
</tr>
</thead>
<tbody>
<tr>
<td>Model failed on format it claimed to support</td>
<td><code>format_misunderstanding</code></td>
<td>0.85</td>
</tr>
<tr>
<td>Unnecessary conversion (model would have understood)</td>
<td><code>unnecessary_conversion</code></td>
<td>0.70</td>
</tr>
<tr>
<td>Model hallucinated file content</td>
<td><code>hallucination_detection</code></td>
<td>0.90</td>
</tr>
<tr>
<td>User gave negative rating</td>
<td><code>user_correction</code></td>
<td>0.85</td>
</tr>
</tbody>
</table>
<p>These feed into the LoRA evolution system for persistent consciousness improvement.</p>
<h3 id="admin-override">Admin Override</h3>
<p>Admins can force conversion regardless of learning:</p>
<pre class="typescript"><code>// Force conversion for a model/format that consistently fails
await fileConversionLearningService.setForceConvert(
  tenantId,
  &#39;claude-3-haiku&#39;,
  &#39;pdf&#39;,
  &#39;Struggles with multi-column PDFs&#39;,
  adminUserId
);

// Clear override
await fileConversionLearningService.clearForceConvert(
  tenantId,
  &#39;claude-3-haiku&#39;,
  &#39;pdf&#39;
);</code></pre>
<h3 id="implementation-files-2">Implementation Files</h3>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lambda/shared/services/file-conversion-learning.service.ts</code></td>
<td>Learning service</td>
</tr>
<tr>
<td><code>migrations/128_file_conversion_learning.sql</code></td>
<td>Database schema</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="./THINKTANK-ADMIN-GUIDE.md#27-intelligent-file-conversion">THINKTANK-ADMIN-GUIDE.md - Section 27</a></li>
<li><a href="./RADIANT-ADMIN-GUIDE.md">RADIANT-ADMIN-GUIDE.md</a></li>
</ul>

  
  <div class="footer">
    RADIANT Documentation | Version 5.52.29 | Generated January 25, 2026
  </div>
</body>
</html>